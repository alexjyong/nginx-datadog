services:
  envoy:
    build:
      context: .
      dockerfile: ./Dockerfile
    ports:
      - '${PORT_WEB:-8080}:8080'
      - '${PORT_WEB:-8081}:8081'
    develop:
      watch:
        - action: sync+restart
          path: ./static
          target: /var/www
          ignore:
            - .git
            - .gitignore
            - .vscode
        - action: rebuild
          path: Dockerfile
        - action: rebuild
          path: docker-compose.yml
        - action: rebuild
          path: envoy.yaml
        - action: rebuild
          path: ./lib/datadog_rum.lua
